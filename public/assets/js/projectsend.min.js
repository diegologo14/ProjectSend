var downloadTimeout,logdownloadTimeout,dataExtraction=function(e){return 1<e.childNodes.length?e.childNodes[1].innerHTML:e.innerHTML},check_download_cookie=function(){1==Cookies.get("download_started")?(Cookies.set("download_started","false",{expires:100}),remove_modal()):downloadTimeout=setTimeout(check_download_cookie,1e3)},check_log_download_cookie=function(){1==Cookies.get("log_download_started")?(Cookies.set("log_download_started","false",{expires:100}),remove_modal()):logdownloadTimeout=setTimeout(check_log_download_cookie,1e3)};function resizeChosen(){$(".chosen-container").each(function(){$(this).attr("style","width: 100%")})}function prepare_sidebar(){jQuery(window).width()<769&&($(".main_menu .active .dropdown_content").hide(),$(".main_menu li").removeClass("active"),$("body").hasClass("menu_contracted")||$("body").addClass("menu_contracted"))}function ajax_widget_news(){var t=$(".widget_news");t.html('<div class="loading-graph"><img src="'+json_strings.uri.assets_img+'ajax-loader.gif" alt="Loading" /></div>'),$.ajax({url:json_strings.uri.widgets+"news.php",data:{ajax_call:!0},success:function(e){t.html(e)},cache:!1})}function ajax_widget_statistics(e){var t=$(".statistics_graph");t.html('<div class="loading-graph"><img src="'+json_strings.uri.assets_img+'ajax-loader.gif" alt="Loading" /></div>'),$.ajax({url:json_strings.uri.widgets+"statistics.php",data:{days:e,ajax_call:!0},success:function(e){t.html(e)},cache:!1})}function ajax_widget_log(e){var t=$(".activities_log");t.html('<div class="loading-graph"><img src="'+json_strings.uri.assets_img+'ajax-loader.gif" alt="Loading" /></div>'),$.ajax({url:json_strings.uri.widgets+"actions-log.php",data:{action:e,ajax_call:!0},success:function(e){t.html(e)},cache:!1})}$(document).ready(function(e){$("#do_action").click(function(){var e=$("td>input:checkbox").serializeArray(),t=$("#action").val();if("none"==t)return!1;if("delete"==t)return 0==e.length?(alert(json_strings.translations.select_one_or_more),!1):(_formatted=sprintf(json_strings.translations.confirm_delete,e.length),!!confirm(_formatted));if("log_clear"==t){var o=json_strings.translations.confirm_delete_log;return!!confirm(o)}if("log_download"==t)return $(document).psendmodal(),Cookies.set("log_download_started",0,{expires:100}),setTimeout(check_log_download_cookie,1e3),$(".modal_content").html('<p class="loading-img"><img src="'+json_strings.uri.assets_img+'ajax-loader.gif" alt="Loading" /></p><p class="lead text-center text-info">'+json_strings.translations.download_wait+"</p>"),$(".modal_content").append('<iframe src="'+json_strings.uri.base+'src/includes/actions.log.export.php?format=csv"></iframe>'),!1;if("unassign"==t)return _formatted=sprintf(json_strings.translations.confirm_unassign,e.length),!!confirm(_formatted);if("zip"==t){var n=$("td>input:checkbox").serializeArray();return $(document).psendmodal(),Cookies.set("download_started",0,{expires:100}),setTimeout(check_download_cookie,1e3),$(".modal_content").html('<p class="loading-img"><img src="'+json_strings.uri.assets_img+'ajax-loader.gif" alt="Loading" /></p><p class="lead text-center text-info">'+json_strings.translations.download_wait+'</p><p class="text-center text-info">'+json_strings.translations.download_long_wait+"</p>"),$.ajax({method:"GET",url:json_strings.uri.base+"process.php",data:{do:"return_files_ids",files:n}}).done(function(e){var t=json_strings.uri.base+"process.php?do=download_zip&files="+e;$(".modal_content").append("<iframe id='modal_zip'></iframe>"),$("#modal_zip").attr("src",t)}),!1}})}),$.fn.psendmodal=function(){$("body").append('<div class="modal_overlay"></div><div class="modal_psend"><div class="modal_title"><span>&nbsp;</span><a href="#" class="modal_close">&times;</a></div><div class="modal_content"></div></div>'),$(".modal_overlay").stop(!0,!0).fadeIn(),$(".modal_psend").stop(!0,!0).fadeIn(),window.remove_modal=function(){return $(".modal_overlay").stop(!0,!0).fadeOut(500,function(){$(this).remove()}),$(".modal_psend").stop(!0,!0).fadeOut(500,function(){$(this).remove()}),!1},$(".modal_close").click(function(e){e.preventDefault(),remove_modal()}),$(".modal_overlay").click(function(e){e.preventDefault(),remove_modal()}),$(document).keyup(function(e){27==e.keyCode&&remove_modal()})},$(document).ready(function(){$(".stats_days").click(function(e){if(e.preventDefault(),$(this).hasClass("btn-inverse"))return!1;var t=$(this).data("days");$(".stats_days").removeClass("btn-inverse"),$(this).addClass("btn-inverse"),ajax_widget_statistics(t)}),$(".log_action").click(function(e){if(e.preventDefault(),$(this).hasClass("btn-inverse"))return!1;var t=$(this).data("action");$(".log_action").removeClass("btn-inverse"),$(this).addClass("btn-inverse"),ajax_widget_log(t)})});var ignore_columns,error_count=0,error_count_options=0;function clean_form(e){$(e).find(":input").each(function(){$(this).hasClass("field_error")&&$(this).removeClass("field_error")}),$(e).find(".validation_error_group").each(function(){$(this).remove()})}function is_complete_all_options(e,t){var o=0;$(e).find(":input:not(.empty)").each(function(){"allowed_file_types_tag"==$(this).attr("id")||0==$(this).val().length&&($(this).addClass("field_error"),o++)}),0<o&&error_count++}function add_error_to_field(e,t){error_count++,$(e).addClass("field_error");var o=$(e).attr("name");if(this_field_msg_name=o.replace(/\[/g,"_"),this_field_msg_name=this_field_msg_name.replace(/\]/g,"_"),0==$("#error_for_"+o).length){var n=$(e).parents(".form-group"),s="field_error_msg";null==ignore_columns&&(s+=" col-sm-8 col-sm-offset-4"),$(n).after('<div class="form-group validation_error_group"><div class="'+s+'" id="error_for_'+this_field_msg_name+'"><ul></ul></div></div>')}$("#error_for_"+this_field_msg_name+" ul").append('<li><i class="glyphicon glyphicon-exclamation-sign"></i> '+t+"</li>")}function is_complete(e,t){0==$(e).val().length&&add_error_to_field(e,t)}function is_selected(e,t){"ps_empty_value"==$(e).val()&&add_error_to_field(e,t)}function is_length(e,t,o,n){($(e).val().length<t||$(e).val().length>o)&&add_error_to_field(e,n)}function is_email(e,t){var o=e.value;0==/^([^@])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,})$/.test(o)&&add_error_to_field(e,t)}function is_alpha(e,t){e.value.match(/^[a-zA-Z0-9]+$/)||add_error_to_field(e,t)}function is_number(e,t){e.value.match(/^[0-9]+$/)||add_error_to_field(e,t)}function is_alpha_or_dot(e,t){e.value.match(/^[a-zA-Z0-9.]+$/)||add_error_to_field(e,t)}function is_password(e,t){e.value.match(/^[0-9a-zA-Z`!"?$%\^&*()_\-+={\[}\]:;@~#|<,>.'\/\\]+$/)||add_error_to_field(e,t)}function is_match(e,t,o){$(e).val()!=$(t).val()&&(add_error_to_field(e,o),add_error_to_field(t,o))}function show_form_errors(){if(0<error_count)return error_count=0,!1}$(document).ready(function(){$("input:first").focus()}),$(function(){return $(".password_toggle").each(function(e,t){var n=$(t),o=$(n).next(".password_toggle");$(".password_toggler button").click(function(){var e="",t=$(this).find("i");e=$(this).hasClass("pass_toggler_show")?($(this).removeClass("pass_toggler_show"),$(this).addClass("pass_toggler_hide"),$(t).removeClass("glyphicon glyphicon-eye-open"),$(t).addClass("glyphicon glyphicon-eye-close"),"text"):($(this).removeClass("pass_toggler_hide"),$(this).addClass("pass_toggler_show"),$(t).removeClass("glyphicon glyphicon-eye-close"),$(t).addClass("glyphicon glyphicon-eye-open"),"password");var o=$("<input type='"+e+"' />").attr("id",n.attr("id")).attr("name",n.attr("name")).attr("class",n.attr("class")).attr("maxlength",n.attr("maxlength")).val(n.val()).insertBefore(n);n.remove(),n=o}).insertBefore(o)}),!1}),$(document).ready(function(){prepare_sidebar(),resizeChosen(),$(".main_menu > li.has_dropdown .nav_top_level").click(function(e){e.preventDefault();var t=$(this).parents(".has_dropdown");$(t).hasClass("active")?($(t).removeClass("active"),$(t).find(".dropdown_content").stop().slideUp()):($("body").hasClass("menu_contracted")&&($(".main_menu li").removeClass("active"),$(".main_menu").find(".dropdown_content").stop().slideUp(100)),$(t).addClass("active"),$(t).find(".dropdown_content").stop().slideDown())}),$(".toggle_main_menu").click(function(e){e.preventDefault(),768<jQuery(window).width()?($("body").toggleClass("menu_contracted"),$("body").hasClass("menu_contracted")?(Cookies.set("menu_contracted","true",{expires:365}),$(".main_menu li").removeClass("active"),$(".main_menu").find(".dropdown_content").stop().hide()):(Cookies.set("menu_contracted","false",{expires:365}),$(".current_nav").addClass("active"),$(".current_nav").find(".dropdown_content").stop().show())):($("body").toggleClass("menu_hidden"),$(".main_menu li").removeClass("active"),$("body").hasClass("menu_hidden")&&$(".main_menu").find(".dropdown_content").stop().hide())}),$(document).on("click",".public_link_copy",function(e){if($(this).select(),document.execCommand("copy"))var t=".copied";else t=".copied_not";$(this).parents(".public_link_modal").find(t).stop().fadeIn().delay(2e3).fadeOut(),$(this).mouseup(function(){return $(this).unbind("mouseup"),!1})}),$("#select_all").click(function(){var e=$(this).prop("checked");$("tr td input[type=checkbox].batch_checkbox").prop("checked",!1),$("tr:visible td input[type=checkbox].batch_checkbox").prop("checked",e)}),$.isFunction($.fn.footable)&&$(".footable").footable().find("> tbody > tr:not(.footable-row-detail):nth-child(even)").addClass("odd");var s=new Jen(!0);s.hardening(!0),$(".btn_generate_password").click(function(e){var t=$(this).parents(".form-group").find(".password_toggle"),o=$(this).data("min"),n=$(this).data("max");$(t).val(s.password(o,n))}),$.isFunction($.fn.datepicker)&&$(".date-container .date-field").datepicker({format:"dd-mm-yyyy",autoclose:!0,todayHighlight:!0}),$(".add-all").click(function(){var e=$(this).data("type"),t=$(this).closest("."+e).find("select");return $(t).find("option").each(function(){$(this).prop("selected",!0)}),$(t).trigger("chosen:updated"),!1}),$(".remove-all").click(function(){var e=$(this).data("type"),t=$(this).closest("."+e).find("select");return $(t).find("option").each(function(){$(this).prop("selected",!1)}),$(t).trigger("chosen:updated"),!1}),$("button").click(function(){$(this).blur()}),$("body").on("click",".public_link",function(e){$(document).psendmodal();var t=$(this).data("type"),o=$(this).data("id"),n=$(this).data("token");if("group"==t)var s=json_strings.uri.public_group+"?",a=json_strings.translations.public_group_note;else if("file"==t)s=json_strings.uri.public_download+"?",a=json_strings.translations.public_file_note;var i='<div class="public_link_modal"><strong>'+json_strings.translations.copy_click_select+'</strong><div class="copied">'+json_strings.translations.copy_ok+'</div><div class="copied_not">'+json_strings.translations.copy_error+'</div><div class="form-group"><textarea class="input-large public_link_copy form-control" rows="4" readonly>'+s+"id="+o+"&token="+n+'</textarea></div><span class="note">'+a+"</span></div>",r=json_strings.translations.public_url;$(".modal_title span").html(r),$(".modal_content").html(i)}),$.isFunction($.fn.chosen)&&$(".chosen-select").chosen({no_results_text:json_strings.translations.no_results,width:"100%",search_contains:!0}),"undefined"!=typeof CKEDITOR&&CKEDITOR.replaceAll("ckeditor")}),jQuery(window).scroll(function(e){}),jQuery(window).resize(function(e){prepare_sidebar(),resizeChosen()});